<%# app/views/listings/_listings_grid.html.erb %>
<%# Erwartet: listings: (Array von Listing) %>

<% if @listings.any? %>
  <div class="listings-container">
    <% @listings.each do |listing| %>
      <div class="listing-card">
        <% if listing.photos.attached? %>
          <div class="listing-photos" data-controller="carousel">
            <% listing.photos.each do |photo| %>
              <%= cl_image_tag photo.key,
                    width: 400, height: 300, crop: :fill,
                    class: "listing-photo hidden",
                    data: { carousel_target: "image" } %>
            <% end %>

            <% if listing.photos.count > 1 %>
              <button type="button"
                      data-action="click->carousel#previous"
                      class="carousel-btn left">â€¹</button>
              <button type="button"
                      data-action="click->carousel#next"
                      class="carousel-btn right">â€º</button>
            <% end %>
          </div>
        <% else %>
          <%= image_tag "placeholder.jpg", class: "listing-photo" %>
        <% end %>

        <div class="listing-card-content">
          <h2 class="listing-title">
            <%= link_to listing.title, listing_path(listing), class: "listing-link" %>
          </h2>
          <p class="listing-desc"><%= listing.description %></p>

          <div class="listing-details">
            <span><%= listing.address %></span>
            <span>â‚¬<%= listing.price_per_night %>/night</span>
            <span>ðŸ‘¥ <%= listing.max_guests %> guests</span>
          </div>
        </div>
      </div>
    <% end %>
  </div>
<% else %>
  <p class="no-listings">No listings found.</p>
<% end %>
