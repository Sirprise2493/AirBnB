<!-- Page header with title and 'New Listing' button -->
<div class="listings-header">
  <h1 class="listings-title">Listings</h1>
  <%= link_to "New Listing", new_listing_path, class: "btn-create" %>
</div>

<% if @listings.any? %>
  <!-- Grid container for all listing cards -->
  <div class="listings-container">
    <% @listings.each do |listing| %>
      <div class="listing-card">
        <% if listing.photos.attached? %>
          <!-- Photo carousel (controlled by Stimulus) -->
          <div class="listing-photos" data-controller="carousel">
            <% listing.photos.each do |photo| %>
              <!-- Each image starts hidden; Stimulus shows one at a time -->
              <%= image_tag url_for(photo),
                  class: "listing-photo hidden",
                  data: { carousel_target: "image" } %>
            <% end %>

            <!-- Carousel navigation buttons (only shown if multiple photos) -->
            <% if listing.photos.count > 1 %>
              <button
                type="button"
                data-action="click->carousel#previous"
                class="carousel-btn left">
                â€¹
              </button>
              <button
                type="button"
                data-action="click->carousel#next"
                class="carousel-btn right">
                â€º
              </button>
            <% end %>
          </div>
        <% else %>
          <!-- Fallback image if no photos are attached -->
          <div class="listing-photos">
            <%= cl_image_tag("placeholder_airbnb", class: "listing-photo") %>
          </div>
        <% end %>

        <!-- Card content (title, description, details) -->
        <div class="listing-card-content">
          <h2 class="listing-title">
            <!-- Link to the listing's show page -->
            <%= link_to listing.title, listing_path(listing), class: "listing-link" %>
          </h2>
          <p class="listing-desc"><%= listing.description %></p>
          <div class="listing-details">
            <span><%= listing.address %></span>
            <span>â‚¬<%= listing.price_per_night %>/night</span>
            <span>ðŸ‘¥ <%= listing.max_guests %> guests</span>
          </div>
        </div>
      </div>
    <% end %>
  </div>
<% else %>
  <!-- Message shown when no listings exist -->
  <p class="no-listings">No listings found.</p>
<% end %>

