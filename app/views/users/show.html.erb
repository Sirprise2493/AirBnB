<h1>Profile page of <%= [@user.first_name, @user.last_name].compact.join(" ") %></h1>



<% @listings.each do |listing| %>
  <p><%= listing.title %></p>

  <%= button_to listing,
                method: :delete,
                data: { turbo_confirm: "Are you sure you want to delete this item?" },
                class: "btn btn-danger rounded-pill px-3" do %>
    <i class="bi bi-trash"></i> Delete
  <% end %>

  <p>-----</p>

  <% listing.bookings.each do |booking| %>
    <p>Start date: <%= booking.start_date %></p>
    <p>End date: <%= booking.end_date %></p>

    <% nights = (booking.end_date - booking.start_date).to_i rescue nil %>
    <p><% if nights && nights > 0 %>(<%= nights %> nights)<% end %></p>

    <p>Number of guests: <%= booking.number_guests %></p>

    <% if booking.total_price.present? %>
      <p><strong>Total:</strong> <%= number_to_currency(booking.total_price, unit: "â‚¬") %></p>
      <p><strong>Booked:</strong> <%= l booking.created_at.to_date %></p>
    <% end %>
    <% label, bs = booking_status_badge(booking) %>
    <span class="badge text-bg-<%= bs %>"><%= label %></span>


    <% if booking.request_status_pending? %>
      <%= button_to accept_booking_path(booking),
                    method: :patch,
                    class: "btn btn-success rounded-pill px-3 me-2",
                    data: { turbo_confirm: "Accept this request?" } do %>
        <i class="bi bi-check2"></i> Accept
      <% end %>

      <%= button_to reject_booking_path(booking),
                    method: :patch,
                    class: "btn btn-outline-danger rounded-pill px-3",
                    data: { turbo_confirm: "Reject this request?" } do %>
        <i class="bi bi-x"></i> Reject
      <% end %>
    <% end %>

    <p>----------------</p>
  <% end %>

  <p>-----------------------------</p>
<% end %>





<%= render partial: "users/listings_made_by_yourself/listings_create_form",
           locals: { listing: @listing } %>


<h2>Bookings fpr your listing:</h2>
<p>Content..................................</p>


<h2>Your Bookings</h2>
<div class="row row-cols-1 row-cols-sm-2 row-cols-lg-3 g-4">
  <%= render partial: "users/bookings_made_by_yourself/bookings_made_by_yourself_card",
             collection: @bookings,
             as: :booking %>
</div>

<%= render partial: "users/reviews/review_section",
           locals: { user: @user, reviews: @reviews, avg_rate: @avg_rate } %>
