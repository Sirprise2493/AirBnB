<article class="card">
  <header class="card-head">
    <%# Show the author's avatar (this profile’s user) or a placeholder %>
    <% if review.user&.photo.present? %>
      <%= cl_image_tag review.user.photo.key,
            class: "avatar", width: 48, height: 48, crop: :thumb, gravity: :face %>
    <% else %>
      <div class="avatar placeholder" aria-hidden="true"></div>
    <% end %>

    <div class="who">
      <div class="name"><%= [review.user&.first_name, review.user&.last_name].compact.join(" ") %></div>
      <div class="meta"><%= relative_time_for(review.created_at) %></div>
      <% if review.listing %>
        <div class="listing-ref">
          about <%= link_to review.listing.title, listing_path(review.listing) %>
        </div>
      <% end %>
    </div>
  </header>

  <div class="stars" aria-label="Rating: <%= review.rating %> out of 5">
    <% 1.upto(5) do |i| %>
      <span class="star <%= i <= review.rating.to_i ? 'filled' : 'empty' %>">★</span>
    <% end %>
  </div>

  <p class="content"><%= simple_format(h(review.content)) %></p>
</article>
